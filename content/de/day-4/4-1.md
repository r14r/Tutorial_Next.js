## Einheit 1 — Datenintegration mit Pandas

### Beispiele

#### Beispiel 1 — CSV laden

```python
import pandas as pd
df = pd.read_csv("sales.csv")
print(df.head())
```

#### Beispiel 2 — Excel laden

```python
df = pd.read_excel("data.xlsx")
print(df.shape)
```

#### Beispiel 3 — Filterung

```python
kunden = df[df["Country"] == "Germany"]
print(kunden)
```

#### Beispiel 4 — LLM-Integration

```python
import requests
stats = df.describe().to_string()
prompt = f"Analysiere die Verkaufsdaten:\n{stats}"
r = requests.post("http://localhost:11434/api/generate",
                  json={"model": "llama2", "prompt": prompt})
print(r.json()["response"])
```

#### Beispiel 1 — CSV laden

```python
# Datei: einheit41_csv_laden.py
import pandas as pd
df = pd.read_csv("sales.csv")
print(df.head())
```

#### Beispiel 2 — Excel laden

```python
# Datei: einheit41_excel_laden.py
import pandas as pd
df = pd.read_excel("data.xlsx")
print(df.shape)
```

#### Beispiel 3 — Filterung

```python
# Datei: einheit41_filterung.py
import pandas as pd
df = pd.read_csv("sales.csv")
kunden = df[df["Country"] == "Germany"]
print(kunden)
```

#### Beispiel 4 — LLM-Integration mit Ollama SDK

```python
# Datei: einheit41_llm_integration.py
import pandas as pd
from lib.helper_ollama import ollama

df = pd.read_csv("sales.csv")
stats = df.describe().to_string()
prompt = f"Analysiere die Verkaufsdaten:\n{stats}"
result = ollama.generate(prompt)
print(result)
```

### Übungen

- Lade eine CSV mit Spalten Name, Alter, Einkommen. Berechne den Median des Einkommens.
- Filtere alle Kunden über 40 Jahre.
- Schicke die Statistik an Ollama und bitte um eine wirtschaftliche Interpretation.
- Sortiere die Kunden nach Einkommen absteigend.

### Lösungen

```python
df = pd.read_csv("kunden.csv")
print(df["Einkommen"].median())
print(df[df["Alter"] > 40])
stats = df.describe().to_string()
prompt = f"Welche wirtschaftlichen Trends lassen sich erkennen?\n{stats}"
print(df.sort_values("Einkommen", ascending=False))
```

---

